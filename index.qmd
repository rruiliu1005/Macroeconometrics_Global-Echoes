---
title: "Global Echoes: Analyzing the Interplay of Economic Indicators Across Leading Economies"
author: "Rui Liu"

execute:
  echo: false
  
bibliography: references.bib
---

# 1. The Question Objective, and Motivation
**Objective:**
Construct a Bayesian Vector Autoregression model to forecast major macroeconomic indicators for the United States, Australia, Japan, and China to facilitate an investigation into the prospective interdependencies between the economies of these nations.

**Question:**
This research project will examine how trade relationships, investment flows, monetary policy environments, and economic performances within the United States, Australia, Japan and China mutually influence each other, and assess the implications of these interactions for predicting future values of these economic indicators.

**Motivation:**
Since the onset of the COVID-19 pandemic, the global economic landscape has witnessed a
series of unprecedented shifts in key macroeconomic indicators, spurred by governments'
adoption of varied expansionary monetary policies. Initially, to buffer their economies,
many nations implemented expansive monetary strategies, later swiftly transitioning to
interest rate hikes in a bid to manage surging inflation rates—a scenario not seen in
decades. The pandemic's disruption to trade further exacerbated inflationary pressures for
some economies, highlighting the intricate interdependencies among major economies
with significant trade and financial ties. This period recorded stark contrast in inflation
levels, with unprecedented highs in the US and Australia and notably low inflation in China
and Japan. Amidst this turmoil, a divergence in economic paths also became apparent, the
United States and Australia have witness robust economic rebounds, whereas China and
Japan saw more tepid recoveries. This research aims to dissect the nuanced web of
economic interdependencies between the United States, Australia, Japan, and China,
analyzing how their trade relationships, investment flows, and monetary policy
environments have mutually influenced their economic performances. Additionally, it
seeks to understand the ramifications of these dynamics for the predictive accuracy of
future economic indicators, offering insights into the evolving global economic order.

# 2. Data and their properties

**Proposed Dataset:**
This research project will utilize data from the International Monetary Fund’s (IMF) extensive database, which offers a comprehensive collection of global economic information. The IMF’s collection includes several key databases such as the World Economic Outlook Databases, International Financial Statistics (IFS), Government Finance Statistics. The analysis will predominantly focus on the IFS database, which encompasses an sizeable collection of financial and economic data from across the global, featuring 1,681 distinct indicators such as consumer price index, interest rates, exchange rates, national accounts, government finance statistics. The data is available in various frequencies – annual, semi-annual, quarterly, monthly, daily, and weekly. As this research is primarily
focused on analyzing macroeconomic data that are published on a monthly or quarterly basis, quarterly data from Q1 2011 to Q3 2023 will be used. The analysis will examine key macroeconomic variables including consumer price indexes, foreign direct investments, exchange rates, balance of payments, and the national gross domestic product of the United States, Australia, Japan, and China.

**Variables and Motivation:**

| Variables                                              | Original Unit          | Final Unit | Mnemonic | Code           |
|--------------------------------------------------------|------------------------|------------|----------|----------------|
| Prices, Consumer Price Index, All items, Previous period | % Change               | % Change   | CPI      | PCPI_PC_PP_PT  |
| International Investment Positions, assets, Direct Investment | US dollar, millions           | % Change   | FDI      | IAD_BP6_USD    |
| Exchange Rates, Domestic Currency per U.S. Dollar, Period Average | US dollar, millions           | % Change   | XCH      | ENDA_XDC_USD_R |
| Balance of Payments, Current Account, Goods and Services, Net | US dollar, millions          | % Change   | BOP      | BGS_BP6_USD    |
| Gross Domestic Product, Real, Seassonally Adjusted, Domestic Currency | Domestic Currency    | % Change   | GDP      | NGDP_NSA_XDC   |

The variables included in this study were chosen with the objective to include key economic indicators that are susceptible to changes in other nations while also having experienced significant fluctuations over the past decade. These variables were chosen not only for their ability to provide insights into the trade relations, investment dynamics and monetary policy frameworks, but also for their roles as barometers of overall economic health and performance. Foreign direct investment (FDI) is a direct indicator of cross- border investment flows and serves as a proxy for economic confidence and integration between nations. Exchange rates directly impact trade balances and investment flows, influencing economic performances. By examining the volatility and trends in exchange rates, insights can be gleaned into how monetary policies and economic conditions in one country can affect its trade partners. Balance of payments is a comprehensive measure that captures the transactions between a country and the rest of the world, offering a holistic view of its economic interactions. For example, some view changes in balance of payments as largely a result of imports and exports, which can cause one country to import the inflation of another country and vice versa. GDP growth is the ultimate measure of economic performance, encapsulating the outcome of various economic activities and policies. Analyzing GDP in the form of percentage change allows for assessing economic momentum and comparing growth rates across countries and over time, offering a clear picture of economic health and trends.
Foreign direct investment, exchange rates, balance of payments and gross domestic products were transformed into percentage change from the previous period, aiming to standardize the data, facilitate temporal comparisons and enhancing the interpretability of trends over time. The presence of cyclical trends in the variables, alongside the observed impact of lagged values on future outcomes, highlights the suitability of the Bayesian Vector Autoregression model for our analysis. This model can well capture the temporal dynamics and interdependencies inherent in these economic indicators, offering a robust framework for understanding the nuanced interactions and feedback loops that characterize their behavior over time.
```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
#################################################################################
#################################################################################
#Download Data 
#################################################################################
#################################################################################

#devtools::install_github('mingjerli/IMFData')
library(IMFData)
library(patchwork)
# https://github.com/mingjerli/IMFData
#find out available dataset in IMF data
availableDB <- DataflowMethod()
#availableDB$DatabaseID

#Findout how many dimensions are available in a given dataset. 
# Available dimension code
IFS.available.codes <- DataStructureMethod("IFS")
#names(IFS.available.codes)
# Possible code in the first dimension
#IFS.available.codes[[1]]
IFS.data.category <-  IFS.available.codes[[3]]
#Search possible code to use in each dimension. 
#Here, we want to search code related to GDP in CL_INDICATOR_IFS dimension
CodeSearch(IFS.available.codes, "CL_INDICATOR_IFS", "CPI")

#Make API call to get data
databaseID <- "IFS"
startdate = "2011-01-01"
enddate = "2023-09-01"
checkquery = FALSE

#International Investment Positions Data
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'IAD_BP6_USD')
CN.FDI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.FDI.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'IAD_BP6_USD')
JP.FDI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.FDI.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'IAD_BP6_USD')
US.FDI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.FDI.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'IAD_BP6_USD')
AU.FDI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.FDI.query$Obs[[1]]



#Exchange Rate
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'ENDA_XDC_USD_RATE')
CN.XCH.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.XCH.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'ENDA_XDC_USD_RATE')
JP.XCH.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.XCH.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'ENDA_XDC_USD_RATE')
US.XCH.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.XCH.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'ENDA_XDC_USD_RATE')
AU.XCH.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.XCH.query$Obs[[1]]

########################################################################
#Pause for 5 seconds before continue execution 
########################################################################
Sys.sleep(5)

#Balance of Payments 
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'BGS_BP6_USD')
CN.BOP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.BOP.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'BGS_BP6_USD')
JP.BOP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.BOP.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'BGS_BP6_USD')
US.BOP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.BOP.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'BGS_BP6_USD')
AU.BOP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.BOP.query$Obs[[1]]

#Bond Yield
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'FITBBE_PA')
CN.IR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                 checkquery)
#CN.IR.query$Obs[[1]]
#Japan
########################################################################
#Pause for 5 seconds before continue execution 
########################################################################
Sys.sleep(5)

queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'FIGB_PA')
JP.IR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                 checkquery)
#JP.IR.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'FIGB_PA')
US.IR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                 checkquery)
#US.IR.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'FIGB_PA')
AU.IR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                 checkquery)
#AU.IR.query$Obs[[1]]

#Government Expenditure
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'NGDP_NSA_XDC')
CN.GDP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.GDP.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'NGDP_NSA_XDC')
JP.GDP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.GDP.query$Obs[[1]]

########################################################################
#Pause for five seconds before continue execution 
########################################################################
Sys.sleep(5)

#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'NGDP_NSA_XDC')
US.GDP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.GDP.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'NGDP_NSA_XDC')
AU.GDP.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.GDP.query$Obs[[1]]


#CPI
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'PCPI_PC_PP_PT')
CN.CPI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.CPI.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'PCPI_PC_PP_PT')
JP.CPI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.CPI.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'PCPI_PC_PP_PT')
US.CPI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.CPI.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'PCPI_PC_PP_PT')
AU.CPI.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.CPI.query$Obs[[1]]


#Unemployment Rate
#China
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "CN", CL_INDICATOR_IFS = 'LUR_PT')
CN.UMR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#CN.UMR.query$Obs[[1]]
#Japan
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "JP", CL_INDICATOR_IFS = 'LUR_PT')
JP.UMR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#JP.UMR.query$Obs[[1]]
#United States
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "US", CL_INDICATOR_IFS = 'LUR_PT')
US.UMR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#US.UMR.query$Obs[[1]]

#Australia
queryfilter <- list(CL_FREA = "Q", CL_AREA_IFS = "AU", CL_INDICATOR_IFS = 'LUR_PT')
AU.UMR.query <- CompactDataMethod(databaseID, queryfilter, startdate, enddate, 
                                  checkquery)
#AU.UMR.query$Obs[[1]]



#################################################################################
#################################################################################
#Plot Data
#################################################################################
#################################################################################

library(zoo)
library(ggplot2)
library(tidyr)
library(dplyr)

CPI_data <- data.frame(CN.CPI.query$Obs[[1]]$`@TIME_PERIOD`, CN.CPI.query$Obs[[1]]$`@OBS_VALUE`, JP.CPI.query$Obs[[1]]$`@OBS_VALUE`, 
                       US.CPI.query$Obs[[1]]$`@OBS_VALUE`, AU.CPI.query$Obs[[1]]$`@OBS_VALUE`)
names(CPI_data) = c('Time', 'China', 'Japan', 'United_States', 'Australia')
CPI_data$Time = as.yearqtr(CPI_data$Time, format = "%Y-Q%q")

CPI_data$Time = as.Date(CPI_data$Time)
CPI_data$China = as.numeric(CPI_data$China)
CPI_data$United_States = as.numeric(CPI_data$United_States)
CPI_data$Japan = as.numeric(CPI_data$Japan)
CPI_data$Australia = as.numeric(CPI_data$Australia)
CPI_data_long <- pivot_longer(CPI_data, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "CPI")

CPI_plot = ggplot(data = CPI_data_long, aes(x = Time, y = CPI, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "CPI (%)", title = "CPI Trends", color = "Country")

#ggsave("CPI.png", plot = CPI_plot, path = paste0(getwd(), "/plots", sep = ""), width = 10, height = 7)

FDI_data <- data.frame(CN.FDI.query$Obs[[1]]$`@TIME_PERIOD`, CN.FDI.query$Obs[[1]]$`@OBS_VALUE`, JP.FDI.query$Obs[[1]]$`@OBS_VALUE`, 
                       US.FDI.query$Obs[[1]]$`@OBS_VALUE`, AU.FDI.query$Obs[[1]]$`@OBS_VALUE`)
names(FDI_data) = c('Time', 'China', 'Japan', 'United_States', 'Australia')
FDI_data$Time = as.yearqtr(FDI_data$Time, format = "%Y-Q%q")

FDI_data$Time = as.Date(FDI_data$Time)
FDI_data$China = as.numeric(FDI_data$China)
FDI_data$United_States = as.numeric(FDI_data$United_States)
FDI_data$Japan = as.numeric(FDI_data$Japan)
FDI_data$Australia = as.numeric(FDI_data$Australia)
FDI_original = FDI_data
FDI_data <- FDI_data %>%
  mutate(across(c(China, Japan, United_States, Australia), 
                ~ (./lag(.) - 1) * 100, 
                .names = "{.col}"))
FDI_original_long <- pivot_longer(FDI_original, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "FDI")

FDI_data_long <- pivot_longer(FDI_data, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "FDI")

FDI_original_plot = ggplot(data = FDI_data_long, aes(x = Time, y = FDI, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "FDI (US dollar, millions)", title = "Foreign Direct Investments", color = "Country")

FDI_plot = ggplot(data = FDI_data_long, aes(x = Time, y = FDI, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "FDI (%change)", title = "Percentage change in Foreign Direct Investments", color = "Country")

#ggsave("FDI.png", plot = FDI_plot, path = paste0(getwd(), "/plots", sep = ""), width = 10, height = 7)

XCH_data <- data.frame(CN.XCH.query$Obs[[1]]$`@TIME_PERIOD`, CN.XCH.query$Obs[[1]]$`@OBS_VALUE`, JP.XCH.query$Obs[[1]]$`@OBS_VALUE`, 
                       US.XCH.query$Obs[[1]]$`@OBS_VALUE`, AU.XCH.query$Obs[[1]]$`@OBS_VALUE`)
names(XCH_data) = c('Time', 'China', 'Japan', 'United_States', 'Australia')
XCH_data$Time = as.yearqtr(XCH_data$Time, format = "%Y-Q%q")

XCH_data$Time = as.Date(XCH_data$Time)
XCH_data$China = as.numeric(XCH_data$China)
XCH_data$United_States = as.numeric(XCH_data$United_States)
XCH_data$Japan = as.numeric(XCH_data$Japan)
XCH_data$Australia = as.numeric(XCH_data$Australia)
XCH_data = subset(XCH_data, select = -United_States)
XCH_original = XCH_data
XCH_data <- XCH_data %>%
  mutate(across(c(China, Japan, Australia), 
                ~ (./lag(.) - 1) * 100, 
                .names = "{.col}"))

XCH_original$Japan = XCH_original$Japan/100
XCH_original$China= XCH_original$China/10

XCH_original_long <- pivot_longer(XCH_original, 
                              cols = c(China, Japan, Australia), 
                              names_to = "Country", 
                              values_to = "XCH")

XCH_original_long$Country_Label <- with(XCH_original_long, ifelse(Country == "China", "China (Yuan '0s)",
                                               ifelse(Country == "Japan", "Japan (Yen '00s)",
                                               ifelse(Country == "Australia", "Australia (AUD)", Country))))
XCH_data_long <- pivot_longer(XCH_data, 
                              cols = c(China, Japan, Australia), 
                              names_to = "Country", 
                              values_to = "XCH")

#XCH_original_long <- XCH_original_long %>% 
#  filter(Country != "United_States")

XCH_original_plot <- ggplot(data = XCH_original_long, aes(x = Time, y = XCH, color = Country_Label)) +
  geom_line() +
  scale_color_manual(values = c("China (Yuan '0s)" = "blue", "Japan (Yen '00s)" = "red", "Australia (AUD)" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "Exchange Rate (Currency per US dollar)", title = "Exchange Rates Against the Dollar", color = "Country")

#XCH_data_long <- XCH_data_long %>% 
#  filter(Country != "United_States")

XCH_plot = ggplot(data = XCH_data_long, aes(x = Time, y = XCH, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "Exchange Rate (%change)", title = "Percentage change in Exchange Rates Against the Dollar", color = "Country")

#ggsave("XCH.png", plot = XCH_plot, path = paste0(getwd(), "/plots", sep = ""), width = 10, height = 7)

BOP_data <- data.frame(CN.BOP.query$Obs[[1]]$`@TIME_PERIOD`, CN.BOP.query$Obs[[1]]$`@OBS_VALUE`, JP.BOP.query$Obs[[1]]$`@OBS_VALUE`, 
                       US.BOP.query$Obs[[1]]$`@OBS_VALUE`, AU.BOP.query$Obs[[1]]$`@OBS_VALUE`)
names(BOP_data) = c('Time', 'China', 'Japan', 'United_States', 'Australia')
BOP_data$Time = as.yearqtr(BOP_data$Time, format = "%Y-Q%q")

BOP_data$Time = as.Date(BOP_data$Time)
BOP_data$China = as.numeric(BOP_data$China)
BOP_data$United_States = as.numeric(BOP_data$United_States)
BOP_data$Japan = as.numeric(BOP_data$Japan)
BOP_data$Australia = as.numeric(BOP_data$Australia)
BOP_original = BOP_data
BOP_data <- BOP_data %>%
  mutate(across(c(China, Japan, United_States, Australia), 
                ~ (./lag(.) - 1) * 100, 
                .names = "{.col}"))

BOP_original_long <- pivot_longer(BOP_original, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "BOP")

BOP_data_long <- pivot_longer(BOP_data, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "BOP")

BOP_original_plot = ggplot(data = BOP_original_long, aes(x = Time, y = BOP, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "BOP  (US dollar, millions)", title = "Balance of Payments", color = "Country")


BOP_plot = ggplot(data = BOP_data_long, aes(x = Time, y = BOP, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "BOP (%change)", title = "Percentage change in Balance of Payments", color = "Country")
#ggsave("BOP.png", plot = BOP_plot, path = paste0(getwd(), "/plots", sep = ""), width = 10, height = 7)

GDP_data <- data.frame(CN.GDP.query$Obs[[1]]$`@TIME_PERIOD`, CN.GDP.query$Obs[[1]]$`@OBS_VALUE`, JP.GDP.query$Obs[[1]]$`@OBS_VALUE`, 
                       US.GDP.query$Obs[[1]]$`@OBS_VALUE`, AU.GDP.query$Obs[[1]]$`@OBS_VALUE`)
names(GDP_data) = c('Time', 'China', 'Japan', 'United_States', 'Australia')
GDP_data$Time = as.yearqtr(GDP_data$Time, format = "%Y-Q%q")

GDP_data$Time = as.Date(GDP_data$Time)
GDP_data$China = as.numeric(GDP_data$China)
GDP_data$United_States = as.numeric(GDP_data$United_States)
GDP_data$Japan = as.numeric(GDP_data$Japan)
GDP_data$Australia = as.numeric(GDP_data$Australia)

#Convert to US dollars and in billion dollars
GDP_original = GDP_data
GDP_original$China = (GDP_original$China / XCH_original$China)/10000
GDP_original$Japan = (GDP_original$Japan / XCH_original$Japan)/100000
GDP_original$Australia = (GDP_original$Australia / XCH_original$Australia)/1000
GDP_original$United_States = (GDP_original$United_States)/1000

GDP_data_percent <- GDP_data %>%
  mutate(across(c(China, Japan, United_States, Australia), 
                ~ (./lag(.) - 1) * 100, 
                .names = "{.col}"))

GDP_original_long <- pivot_longer(GDP_original, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "GDP")

GDP_data_long <- pivot_longer(GDP_data_percent, 
                              cols = c(China, Japan, United_States, Australia), 
                              names_to = "Country", 
                              values_to = "GDP")

GDP_original_plot = ggplot(data = GDP_original_long, aes(x = Time, y = GDP, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "GDP (US dollar, billions)", title = "GDP", color = "Country")


GDP_plot = ggplot(data = GDP_data_long, aes(x = Time, y = GDP, color = Country)) +
  geom_line() +
  scale_color_manual(values = c("China" = "blue", "Japan" = "red", "United_States" = "green", "Australia" = "orange")) +
  theme_minimal() +
  labs(x = "Time", y = "GDP (%change)", title = "Percentage change in GDP", color = "Country")
#ggsave("GDP.png", plot = GDP_plot, path = paste0(getwd(), "/plots", sep = ""), width = 10, height = 7)

blank_plot <- ggplot() + 
  theme_void() + 
  theme(plot.background = element_blank(), panel.grid = element_blank(), panel.border = element_blank())
```
## Data Plots 
**Original Variables** 
```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
layout <- (FDI_original_plot | BOP_original_plot) / (XCH_original_plot | GDP_original_plot)
layout
```
**Transformed Variables**
```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
layout <- (CPI_plot | FDI_plot) / (XCH_plot | BOP_plot) / (GDP_plot | blank_plot)
layout 
```

## Stationarity Check 

**Stationary Tests** 

The Augmented Dickey-Fuller Test is used in this section to test the null hypothesis that a unit root is present in the time series and the time series is non-stationary. 


```{r, echo=FALSE, message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
#install.packages("tseries")
library(tseries)
library(knitr)
perform_adf_test <- function(series) {
  adf_test <- adf.test(series, alternative = "stationary", k = 4)
  list(
    statistic = adf_test$statistic,
    lag.order = as.numeric(adf_test$parameter),
    p.value = adf_test$p.value
  )
}

results <- sapply(CPI_data[,2:5], perform_adf_test)
results_df <- as.data.frame(t(results), stringsAsFactors = FALSE)
names(results_df) <- c("Dickey-Fuller Statistic", "Lag Order", "P-value")
results_df$Country <- rownames(results_df)
rownames(results_df) <- NULL
kable(results_df, caption = "ADF Test Results for CPI Data by Country")
```
The lag order chosen in the ADF test is 4, which is appropriate given our data is of quarterly frequency. The result of the ADF test on the CPI data shows that we do not have enough evidence to reject the null hypothesis that the CPI series is unit root non-stationary at 1% significance level. 
```{r, echo=FALSE, message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
results <- sapply(FDI_data[2:nrow(FDI_data),2:5], perform_adf_test)
results_df <- as.data.frame(t(results), stringsAsFactors = FALSE)
names(results_df) <- c("Dickey-Fuller Statistic", "Lag Order", "P-value")
results_df$Country <- rownames(results_df)
rownames(results_df) <- NULL
kable(results_df, caption = "ADF Test Results for Foreign Direct Investment (% change) Data by Country")
```
The ADF results shows that we have enough evidence to reject the null hypothesis that the foreign direct investment (% change) data is not unit-root stationary for Australia, the United States and Japan at 1% significance level and we do have enough evidence to reject the null hypothesis for China at 1% significance level. 





```{r, echo=FALSE, message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
results <- sapply(XCH_data[2:nrow(XCH_data),2:4], perform_adf_test)
results_df <- as.data.frame(t(results), stringsAsFactors = FALSE)
names(results_df) <- c("Dickey-Fuller Statistic", "Lag Order", "P-value")
results_df$Country <- rownames(results_df)
rownames(results_df) <- NULL
kable(results_df, caption = "ADF Test Results for Exchange Rate (% change) Data by Country")
```

The result of the ADF test on the exchange rate data shows that we do not have enough evidence to reject the null hypothesis that the exchange rate (%change) against the dollar series is unit root non-stationary at 1% significance level. 

```{r, echo=FALSE, message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}

results <- sapply(BOP_data[2:nrow(BOP_data),2:5], perform_adf_test)
results_df <- as.data.frame(t(results), stringsAsFactors = FALSE)
names(results_df) <- c("Dickey-Fuller Statistic", "Lag Order", "P-value")
results_df$Country <- rownames(results_df)
rownames(results_df) <- NULL
kable(results_df, caption = "ADF Test Results for Balance of Payments (% change) Data by Country")
```
The result of the ADF test on the balance of payments data shows that we do not have enough evidence to reject the null hypothesis that the balance of payments (%change) series is unit root non-stationary at 5% significance level for all countries except for China. 

```{r, echo=FALSE, message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}

results <- sapply(GDP_data_percent[2:nrow(GDP_data_percent),2:5], perform_adf_test)
results_df <- as.data.frame(t(results), stringsAsFactors = FALSE)
names(results_df) <- c("Dickey-Fuller Statistic", "Lag Order", "P-value")
results_df$Country <- rownames(results_df)
rownames(results_df) <- NULL
kable(results_df, caption = "ADF Test Results for GDP (% change) Data by Country")
```

The result of the ADF test on the GDP data shows that we do not have enough evidence to reject the null hypothesis that the GDP (%change) series is unit root non-stationary at 5% significance level.


The results from the ADF tests indicates that further transformations are needed to achieve stationarity for most of the variables included in this research. 


<!--
**ACF and PACF plots ** 
The Autocorrelation Function (ACF) shows the correlation of the series with its own lags, which is typically used to identify the potential moving average (MA) order. The Partial Autocorrelation Function shows the correlation of the series with its own lags that is not explained by correlations at all lower-lag oders, which can be helpful in idendifying the potential autoregressive order (AR). 
```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE, , fig.width=12, fig.height=13}
par(mfrow = c(2, 2))
acf(CPI_data$Australia, main = "ACF for Australian CPI")
pacf(CPI_data$Australia, main = "PACF for Australian CPI")
acf(CPI_data$China, main = "ACF for Chinese CPI")
pacf(CPI_data$China, main = "PACF for Chinese CPI")
acf(CPI_data$Japan, main = "ACF for Japanese CPI")
pacf(CPI_data$Japan, main = "PACF for Japanese CPI")
acf(CPI_data$United_States, main = "ACF for US CPI")
pacf(CPI_data$United_States, main = "PACF for US CPI")
```

-->

# 3. The Model and Hypothesis

**VAR(p) Model:**

$$ Y = XA+E$$
$$E|X \sim \mathcal{MN}_{T \times N}(0_{T \times N},\Sigma_{N \times N}, I_T)$$
$$
A = \begin{bmatrix}
\mu_0^T \\
A_1^T \\
\vdots \\
A_p^T
\end{bmatrix}
, \quad
Y = \begin{bmatrix}
y_1^T \\
y_2^T \\
\vdots \\
y_T^T
\end{bmatrix}
, \quad
x_t = \begin{bmatrix}
1 \\
y_{t-1}^T \\
\vdots \\
y_{t-p}^T
\end{bmatrix}
, \quad
X = \begin{bmatrix}
x_1^T \\
x_2^T \\
\vdots \\
x_T^T
\end{bmatrix}
, \quad
E = \begin{bmatrix}
e_1^T \\
e_2^T \\
\vdots \\
e_T^T
\end{bmatrix}
$$

where 

- $T$ is the number of time periods under consideration
- $N$ is the number of variables, in our case, N = 20
- $P$ is the number of lags
- $Y$ is a $T \times N$ matrix of variables of response variables we aim to model.
- $A$ is a $(1+𝑝\times N) \times N$ matrix of coefficients.
- $E$ is a $T \times N$ matrix of the error terms
- $X$ is a $T \times (1+𝑝\times N)$ matrix of covariates
- $\Sigma$ is a $N \times N$ matrix representing the row-specific covariance matrix
- $I_T$ is a $T \times T$ identity matrix representing the column specific covariance matrix
- $E|X$ follows a matrix-variate normal distribution with mean $0_{T \times N}$, row specific covariance matrix $\Sigma_{N \times N}$ and column specific covariance matrix $I_T$

The Bayesian Vector Autoregression model as formulated above provides a robust framework for investigating the relationships among selected economic indicators across different nations. By employing this model, this research aims to quantitatively measure the influence of one country’s economic indicators on another, such as how lagged changes in China’s inflation rate, may influence the GDP growth rate of the United States and vice versa. The BVAR model, with its estimation of coefficients across various lags, offers a deep understanding of both immediate and more delayed economic interactions, which is crucial to analyzing the cyclical nature of trade relationships, investment flows, monetary policy environments, and economic performances and the transmission of these metrics across borders.
The strength of this BVAR model lies in its ability to incorporate prior economic knowledge and beliefs into the estimation process. By setting prior distributions for the matrix of coefficients A and the covariance matrix $\Sigma$, the model can be tailors to reflect established economic theories regarding international economic linkages and the time it takes for policy changes in one country to affect another. By calibrating the prior variances, particularly for the autoregressive coefficients, we can integrate prior knowledge or hypotheses, such as the presence of unit roots or the diminishing influence of distant lags on current values, into the analysis. When interpreting the estimation output, attention will be given to the posterior means and variances of the coefficients, which represent the model’s “learnt” understanding of the underlying economic structure. The analysis will be supplemented by forecast error variance decompositions to better understand the proportion of the movements in economic indicators that can be accounted for by their own shocks versus shocks to other variables.

The economic context underscoring this analysis is the increased globalization over the past decade, marking an era where economies are more intertwined than ever through trade, capital flows, and policy decisions. This period has witnessed not only the strengthening of global economic ties but also recent calls from political leaders advocating for a reduction in globalization. These contrasting dynamics highlight the complexity of the current global economic landscape, where the push for deeper integration coexists with growing sentiments for retrenchment. This dual trend sets the stage for our investigation, providing a rich context to explore how economic variables across nations influence each other amidst fluctuating levels of global interconnectedness. In this environment, understanding the cross-country spillover effects is vital for policymakers and businesses alike, as decisions made in one country can have far-reaching implications. By addressing these aspects, this research will contribute to the discourse on economic policy formulation, risk assessment, and strategic planning. 
